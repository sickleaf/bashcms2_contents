---
articleTitle: 謎解き解き（○○するシェル芸ちゃん_18日目）
Keywords: ○○するシェル芸ちゃん, bash, シェル芸
Copyright: (C) 2021 sickleaf
---


<br>

[○○するシェル芸ちゃん](../../?page=advent_shellgeichan)アドベントカレンダーの18日目です。
<br><br>

1週以上遅れてるけど完走するんだ絶対に！

## 問題

```
謎解きの暗号化された文とヒントがセットになった問題データが含まれています。
ヒントを元に、暗号化された文を解いて下さい。
```

#### 問題データ(`cat data`)
```
たぬき,きょたたうたのたおやたたつたたはたたホたットたたドたッたグ
まぬけ,まはまままんまにまんままはまヤまスま
とりい,こいとしいのいいえといはいなにい
むしば,ゆばばうしばょうばばはかばいばきいばえすばばばどばんばぐばりあばーるばぴーばじばー
かがみ,かぎめかぎかかりょうてかぎあし
```

この程度の謎解きであれば無機質にワンライナーで片付けてしまいましょう。


## 回答方針

ヒントで使う平仮名を拾い、暗号化文の置き換える処理をawkで実装します。

当初sedでやるつもりだったんですがどうも上手くいかず…sedの別解あるよというシェル芸人は是非…

### ヒントの鍵になる平仮名を拾う

「たぬき」における「た」、「むしば」における「ば」、「かがみ」における「か」「み」を置換に使うので変数に格納します。

[awkのmatch](https://www.greptips.com/posts/1256/)を使います。

「たぬき」や「まぬけ」の場合、「ぬき」や「ぬけ」の前にある1文字を拾うので、正規表現は`(.)(ぬき|ぬけ)`となります。

```
$ cat data | awk -F, '{match($1,/(.)(ぬき|ぬけ)/,a); print a[1],$0}'
た たぬき,きょたたうたのたおやたたつたたはたたホたットたたドたッたグ
ま まぬけ,まはまままんまにまんままはまヤまスま
 とりい,こいとしいのいいえといはいなにい
 むしば,ゆばばうしばょうばばはかばいばきいばえすばばばどばんばぐばりあばーるばぴーばじばー
 かがみ,かぎめかぎかかりょうてかぎあし
```

マッチした文字列が`a`で、`a[n]`でn番目の括弧にマッチしたものが入るため`a[1]`で取り出せます。

問題データのヒントには3パターンありますので、それぞれ対応していきます。

```
$ cat data | awk -F, '{match($1,/(.)(ぬき|ぬけ)/,a); match($1,/(とり|むし)(.)/,b); match($1,/(.)が(.)/,c); print a[1],b[2],c[1],c[2],$0}'
た    たぬき,きょたたうたのたおやたたつたたはたたホたットたたドたッたグ
ま    まぬけ,まはまままんまにまんままはまヤまスま
 い   とりい,こいとしいのいいえといはいなにい
 ば   むしば,ゆばばうしばょうばばはかばいばきいばえすばばばどばんばぐばりあばーるばぴーばじばー
  か み かがみ,かぎめかぎかかりょうてかぎあし
```

「とりい」「むしば」は最後の文字、「かがみ」はがの前後両方を拾うため、`b[2]`、`c[1],c[2]`で拾います。

### 暗号文部分を置換

ヒントと暗号文部分がカンマで区切られているため`-F,`とするとヒント部分が`$1`,暗号文部分が`$2`となります。

拾ってきた文字が置換前・置換後に使うため`gsub`の第一、第二引数に指定します。

第三引数には暗号文部分の`$2`を指定すれば置換出来るため、最後に`$2`を表示すればヒントによる置換が適用された文が表示されます。

## 回答例

`cat data | awk -F, '{match($1,/(.)(ぬき|ぬけ)/,a); match($1,/(とり|むし)(.)/,b); match($1,/(.)が(.)/,c); gsub(a[1],"",$2); gsub(b[2],"",$2); gsub(c[1],c[2],$2); print $2 }'`

```
$ cat data | awk -F, '{match($1,/(.)(ぬき|ぬけ)/,a); match($1,/(とり|むし)(.)/,b); match($1,/(.)が(.)/,c); gsub(a[1],"",$2); gsub(b[2],"",$2); gsub(c[1],c[2],$2); print $2 }'
きょうのおやつはホットドッグ
はんにんはヤス
ことしのえとはなに
ゆうしょうはかいきいえすどんぐりあーるぴーじー
みぎめみぎみみりょうてみぎあし
```


<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">きょうのおやつはホットドッグ<br>はんにんはヤス <a href="https://t.co/a51isLnbg1">https://t.co/a51isLnbg1</a></p>&mdash; シェル芸bot (@minyoruminyon) <a href="https://twitter.com/minyoruminyon/status/1476040062945361921?ref_src=twsrc%5Etfw">December 29, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

謎解きが競技化される前、まだ「たぬき」「まぬけ」くらいでやってた牧歌的な頃があったはずなのですがもはや思い出せない。

競技になってから個人的には[こういう目](https://twitter.com/ShinChan773/status/1248847265319407620)で見ています。

でも競技化すると多くの人の目に触れるための名刺になるのでそれはそれで大事。ダンジョンだってそうで、在野の天才が[まとめ](https://www.youtube.com/watch?v=Rz62DX3QS8U)を作って間口が広がったりする訳です。


## ○○する芸能ちゃんブロック

行動するところまで含め、芸能好きにおける在野の天才はここにあると思っています。

<div class="youtube">
<iframe width="560" height="315" src="https://www.youtube.com/embed/mMMrq3Qr97Y" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

<style>
.youtube {
  position: relative;
  width: 100%;
  padding-top: 56.25%;
}
.youtube iframe {
  position: absolute;
  top: 0;
  right: 0;
  width: 100% !important;
  height: 100% !important;
}
</style>
